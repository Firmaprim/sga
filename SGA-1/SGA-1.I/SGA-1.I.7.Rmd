## 7. Local construction of unramified and étale morphisms {#I.7}

::: {.itenv #I.7.1 title="Proposition 7.1"}
  Let $A$ be a Noetherian ring, $B$ an algebra which is finite over $A$, and $u$ a generator of $B$ over $A$.
  Let $F\in A[t]$ be such that $F(u)=0$ (we do not assume $F$ to be monic), and $u'=F'(u)$ (where $F'$ is the differentiated polynomial).
  Let $\frak{q}$ be a prime ideal of $B$ not containing $u'$, and $\frak{p}$ its intersection with $A$.
  Then $B_\frak{q}$ is unramified over $A_\frak{p}$.
:::

In other words, taking $Y=\Spec(A)$, $X=\Spec(B)$, and $X_{u'}=\Spec(B_{u'})$, we claim that $X_{u'}$ is unramified over $Y$.
This statement follows from the following, more precise:

::: {.itenv #I.7.2 title="Corollary 7.2"}
  The different ideal of $B/A$ contains $u'B$, and is equal to $u'B$ if the natural homomorphism $A[t]/FA[t]\to B$ (sending $t$ to $u$) is an isomorphism.
}
:::

\oldpage{9}

::: {.proof}
Let $J$ be the kernel of the homomorphism $C=A[t]\to B$, so that $J$ contains $FA[t]$, and is equal to it in the second case described in [7.2](#I.7.2).
Since the homomorphism $C\to B$ is surjective, $\Omega_{B/A}^1$ can be identified with the quotient of $\Omega_{C/A}^1$ by the sub-module generated by $J\Omega_{C/A}^1$ and $\dd(J)$ (we should have explicitly described the definition of the homomorphism $d$ and the calculation of $\Omega^1$ for an algebra of polynomials in [§1](#I.1)).
Identifying $\Omega_{C/A}^1$ with $C$, via the basis $\dd t$, we obtain $B/B\cdot J'$, and so the different ideal is generated by the set $J'$ of images in $B$ of derivatives of $G\in J$ (and it suffices to take $G$ that generate $J$).
Since $F\in J$ (resp. $F$ is a generator of $J$), we are done.
:::

We thus find:

::: {.itenv #I.7.3 title="Corollary 7.3"}
  Under the conditions of [7.1](#I.7.1), and supposing that $F$ is monic and that $A[t]/FA[t]\to B$ is an isomorphism, in order for $B_\frak{q}$ to be étale over $A_\frak{p}$, it is necessary and sufficient for $\frak{q}$ to not contain $u'$.
:::

::: {.proof}
  Since $B$ is flat over $A$, being étale is equivalent to being unramified, and we can apply [7.2](#I.7.2).
:::

::: {.itenv #I.7.4 title="Corollary 7.4"}
  Under the conditions of [7.3](#I.7.3), in order for $B$ to be étale over $A$, it is necessary and sufficient for $u'$ to be invertible, or for the ideal $F'$ generated by $F$ in $A[t]$ to be the unit ideal.
:::

::: {.proof}
  The second claim follows from the first along with Nakayama (in $B$).
:::

A monic polynomial $F\in A[t]$ that has the property stated in [7.4](#I.7.4) is said to be a _separable polynomial_ (if $F$ is not monic, we must at least require that the coefficient of its leading term be invertible; in the case where $A$ is a field, we recover the usual definition).

::: {.itenv #I.7.5 title="Corollary 7.5"}
  Let $B$ be an algebra which is _finite_ over the _local_ ring $A$.
  Suppose that $K(A)$ is infinite, or that $B$ is local.
  Let $n$ be the rank of $L=B\otimes_A K(A)$ over $K(A)=k$.
  For $B$ to be unramified (resp. étale) over $A$, it is necessary and sufficient for $B$ to be isomorphic to a quotient of (resp. isomorphic to) $A[t]/FA[t]$, where $F$ is a separable monic polynomial, which we can assume to be (resp. which is necessarily of) degree $n$.
:::

::: {.proof}
  We only have to prove necessity.
  Suppose that $B$ is unramified over $A$, and thus that $L$ is separable over $k$.
  It then follows from the hypotheses that $L/k$ admits a generator $\xi$, and thus the $\xi^i$ (for $0\leq i<n$) form a basis for $L$ over $k$.
  Let $u\in B$ be a lift of $\xi$;
  by Nakayama, the $u^i$ (for $0\leq i<n$) generate (resp. form a basis of) the $A$-module $B$, and, in particular, we obtain a monic polynomial $F\in A[t]$ such that $F(u)=0$;
  $B$ is then isomorphic to a quotient of (resp. isomorphic to) $A[t]/FA[t]$.
  Finally, by applying [7.4](#I.7.4) to $L/k$, we see that $F$ and $F'$ generate $A[t]$ modulo $\frak{m}A[t]$, and so (by Nakayama in $A[t]/FA[t]$) $F$ and $F'$ generate $A[t]$, and we are done.
:::

::: {.itenv #I.7.6 title="Theorem 7.6"}
  Let $A$ be a local ring, and $A\to\cal{O}$ a local homomorphism such that $\cal{O}$ is isomorphic to the localisation of an algebra of finite type over $A$.
  Suppose that $\cal{O}$ is _unramified_ over $A$.
  Then we can find an $A$-algebra $B$ which is integral over $A$, a maximal ideal $\frak{n}$ of $B$, a generator $u$ of $B$ over $A$, and a monic polynomial $F\in A[t]$ such that $\frak{n}\not\ni F'(u)$ and such that $\cal{O}$ is isomorphic (as an $A$-algebra) to $B_\frak{n}$.
  If $\cal{O}$ is étale over $A$, then we can take $B=A[t]/FA[t]$.
:::

\oldpage{10}

(Of course, these conditions are more than sufficient ...)

Before proving [7.6](#I.7.6), we first state some nice corollaries:

::: {.itenv #I.7.7 title="Corollary 7.7"}
  For $\cal{O}$ to be unramified over $A$, it is necessary and sufficient for $\cal{O}$ to be isomorphic to the quotient of an algebra which is unramified and _étale_ over $A$.
:::

::: {.proof}
  We can take $\cal{O}'=B'_{\frak{n}'}$, where $B'=A[t]/FA[t]$ and where $\frak{n}'$ is the inverse image of $\frak{n}$ in $B'$.
:::

::: {.itenv #I.7.8 title="Corollary 7.8"}
  Let $f\colon X\to Y$ be a morphism of finite type, and $x\in X$.
  For $f$ to be unramified at $x$, it is necessary and sufficient for there to exist an open neighbourhood $U$ of $x$ such that $f|U$ factors as $U\to X'\to Y$, where the first arrow is a closed immersion, and the second is an étale morphism.
:::

::: {.proof}
  This is a simple translation of [7.7](#I.7.7).
:::

We will now show how the jargon of [7.6](#I.7.6) follows from the main theorem:
there exists, by [7.7](#I.7.7), an epimorphism $\cal{O}'\to\cal{O}$, where $\cal{O}$ has all the desired properties;
but since $\cal{O}'$ and $\cal{O}$ are étale over $A$, the morphism $\cal{O}'\to\cal{O}$ is étale by [4.8](#I.4.8), and thus an isomorphism.

::: {.proof name="of Theorem 7.6"}
  This
:::